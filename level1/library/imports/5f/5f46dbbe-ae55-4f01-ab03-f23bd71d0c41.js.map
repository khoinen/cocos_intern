{"version":3,"sources":["assets/Scripts/Setting.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AACA,+BAA0B;AAGpB,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAC1C,IAAM,KAAK,GAAG,EAAE,CAAC,KAAK,CAAC;AAEvB;IAAqC,2BAAY;IAAjD;QAAA,qEAwGC;QAtGG,WAAK,GAAc,IAAI,CAAC;QAGxB,WAAK,GAAc,IAAI,CAAC;QAGxB,YAAM,GAAY,IAAI,CAAC;QAGvB,eAAS,GAAY,IAAI,CAAC;QAElB,WAAK,GAAG,IAAI,CAAC;QACb,kBAAY,GAAG,IAAI,CAAC;;IA0FhC,CAAC;IAxFG,wBAAM,GAAN;QACI,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,CAAC,CAAC;QACxB,IAAI,CAAC,SAAS,CAAC,KAAK,GAAG,GAAG,CAAC;QAC3B,IAAI,CAAC,SAAS,CAAC,OAAO,GAAG,CAAC,CAAC;QAC3B,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC,KAAK,CAAC,UAAU,CAAC;IAC3C,CAAC;IAED,0BAAQ,GAAR;QAAA,iBAUC;QATG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QAC7C,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;QAE9E,cAAI,CAAC,OAAO,CAAC,cAAI,CAAC,SAAS,EAAE,UAAC,GAAG,EAAE,IAAI;YACnC,KAAI,CAAC,KAAK,GAAG,IAAI,CAAA;YACjB,KAAI,CAAC,KAAK,CAAC,SAAS,GAAG,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YAC1C,KAAI,CAAC,KAAK,CAAC,SAAS,GAAG,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC;QAC9C,CAAC,CAAC,CAAC;IACP,CAAC;IAED,2BAAS,GAAT;QACI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IAClD,CAAC;IAED,4BAAU,GAAV;QAAA,iBAUC;QATG,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,EAAC,OAAO,EAAE,GAAG,EAAC,CAAC;aAC7B,IAAI,CAAC;YACF,KAAK,CAAC,KAAI,CAAC,SAAS,CAAC,CAAC,QAAQ,CAC1B,KAAK,EAAE,CAAC,EAAE,CAAC,GAAG,EAAE,EAAC,OAAO,EAAE,GAAG,EAAC,CAAC,EAC/B,KAAK,EAAE,CAAC,EAAE,CAAC,GAAG,EAAE,EAAC,KAAK,EAAE,CAAC,EAAC,EAAE,EAAC,MAAM,EAAE,UAAU,EAAC,CAAC,CACpD;iBACA,KAAK,EAAE,CAAC;QACb,CAAC,CAAC;aACD,KAAK,EAAE,CAAC;IACzB,CAAC;IAED,6BAAW,GAAX,UAAY,QAAQ;QAChB,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,EAAC,OAAO,EAAE,CAAC,EAAC,CAAC,CAAC,KAAK,EAAE,CAAC;QACjD,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,QAAQ,CAC1B,KAAK,EAAE,CAAC,EAAE,CAAC,GAAG,EAAE,EAAC,OAAO,EAAE,CAAC,EAAC,CAAC,EAC7B,KAAK,EAAE,CAAC,EAAE,CAAC,GAAG,EAAE,EAAC,KAAK,EAAE,GAAG,EAAC,EAAE,EAAC,MAAM,EAAE,UAAU,EAAC,CAAC,CACtD;aACA,IAAI,CAAC,QAAQ,CAAC;aACd,KAAK,EAAE,CAAC;IACb,CAAC;IAED,yBAAO,GAAP;QAAA,iBAIC;QAHG,IAAI,CAAC,WAAW,CAAC;YACb,KAAI,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QAC7B,CAAC,CAAC,CAAC;IACP,CAAC;IAED,gCAAc,GAAd,UAAe,KAAK;QAChB,QAAQ,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,EAChC;YACI,KAAK,aAAa;gBACd,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,SAAS,CAAC;gBACrC,cAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,cAAI,CAAC,SAAS,CAAC,CAAC;gBAC1C,MAAM;YACV,KAAK,aAAa;gBACd,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,SAAS,CAAC;gBACrC,cAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,cAAI,CAAC,SAAS,CAAC,CAAC;gBAC1C,IAAI,KAAK,CAAC,SAAS,EACnB;oBACI,IAAI,CAAC,SAAS,EAAE,CAAC;iBACpB;qBAED;oBACI,IAAI,CAAC,SAAS,EAAE,CAAC;iBACpB;gBACD,MAAM;SACb;IACL,CAAC;IAED,kCAAgB,GAAhB;QACI,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC;QAC1B,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC;QAC1B,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;QAC1C,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;QAC1C,cAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,cAAI,CAAC,SAAS,CAAC,CAAC;IAC9C,CAAC;IAED,2BAAS,GAAT;QACI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;IACpC,CAAC;IAED,2BAAS,GAAT;QACI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;IACpC,CAAC;IArGD;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;0CACI;IAGxB;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;0CACI;IAGxB;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;2CACK;IAGvB;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;8CACQ;IAXT,OAAO;QAD3B,OAAO;OACa,OAAO,CAwG3B;IAAD,cAAC;CAxGD,AAwGC,CAxGoC,EAAE,CAAC,SAAS,GAwGhD;kBAxGoB,OAAO","file":"","sourceRoot":"/","sourcesContent":["import EffectManager from \"./EffectManager\";\nimport Data from \"./Data\";\n\n\nconst {ccclass, property} = cc._decorator;\nconst tween = cc.tween;\n@ccclass\nexport default class Setting extends cc.Component {\n    @property(cc.Toggle)\n    sound: cc.Toggle = null;\n\n    @property(cc.Toggle)\n    music: cc.Toggle = null;\n\n    @property(cc.Node)\n    shadow: cc.Node = null;\n\n    @property(cc.Node)\n    container: cc.Node = null;\n\n    private _data = null;\n    private _gameManager = null;\n\n    onLoad(): void {\n        this.shadow.opacity = 0;\n        this.container.scale = 0.7;\n        this.container.opacity = 0;\n        this.node.zIndex = cc.macro.MAX_ZINDEX;\n    }\n\n    onEnable(): void {\n        this.node.on(\"touchend\", this.onClose, this);\n        this.effectOpen();\n        this._gameManager = cc.find(\"Canvas/GameManager\").getComponent(\"GameManager\");\n        \n        Data.getData(Data.LOCAL_KEY, (err, data) => {\n            this._data = data\n            this.music.isChecked = this._data.isMusic;\n            this.sound.isChecked = this._data.isSound;\n        });\n    }\n\n    onDisable(): void {\n        this.node.off(\"touchend\", this.onClose, this);\n    }\n\n    effectOpen(): void {\n        tween(this.shadow).to(0.2, {opacity: 200})\n                    .call(() => {\n                        tween(this.container).parallel(\n                            tween().to(0.2, {opacity: 255}),\n                            tween().to(0.2, {scale: 1}, {easing: \"quartOut\"})\n                        )\n                        .start();\n                    })\n                    .start();\n    }\n\n    effectClose(callback): void {\n        tween(this.shadow).to(0.2, {opacity: 0}).start();\n        tween(this.container).parallel(\n            tween().to(0.2, {opacity: 0}),\n            tween().to(0.2, {scale: 0.7}, {easing: \"quartOut\"})\n        )\n        .call(callback)\n        .start();\n    }\n\n    onClose(): void {\n        this.effectClose(() => {\n            this.node.active = false;\n        });\n    }\n\n    onChangeToggle(event) {\n        switch (event.target.parent.name)\n        {\n            case \"ToggleSound\":\n                this._data.isSound = event.isChecked;\n                Data.saveData(this._data, Data.LOCAL_KEY);\n                break;\n            case \"ToggleMusic\":\n                this._data.isMusic = event.isChecked;\n                Data.saveData(this._data, Data.LOCAL_KEY);\n                if (event.isChecked)\n                {\n                    this.playMusic();\n                }\n                else\n                {\n                    this.stopMusic();\n                }\n                break;\n        }\n    }\n\n    onRestoreSetting(): void {\n        this._data.isSound = true;\n        this._data.isMusic = true;\n        this.sound.isChecked = this._data.isSound;\n        this.music.isChecked = this._data.isMusic;\n        Data.saveData(this._data, Data.LOCAL_KEY);\n    }\n\n    stopMusic(): void {\n        this._gameManager.stopAudioBG();\n    }\n\n    playMusic(): void {\n        this._gameManager.playAudioBG();\n    }\n}\n"]}